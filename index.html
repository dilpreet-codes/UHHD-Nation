<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UHHD Nation - Minecraft Shopping</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
            min-height: 100vh;
        }

        #canvas {
            display: block;
            width: 100%;
            height: 100vh;
        }

        #title {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 72px;
            font-weight: bold;
            color: #fff;
            text-shadow: 4px 4px 0px rgba(0, 0, 0, 0.5);
            opacity: 0;
            animation: fadeInAndOut 5s ease-in-out forwards;
            font-family: 'Minecraft', Arial, sans-serif;
            letter-spacing: 3px;
            z-index: 10;
            padding: 20px;
            text-align: center;
        }

        @keyframes fadeInAndOut {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        #itemsContainer {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 1400px;
            opacity: 0;
            animation: slideUp 1s ease-out forwards;
            animation-delay: 5s;
            z-index: 5;
            height: calc(100vh - 100px);
            overflow-y: scroll;
            overflow-x: hidden;
        }

        #itemsContainer::-webkit-scrollbar {
            width: 8px;
        }

        #itemsContainer::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        #itemsContainer::-webkit-scrollbar-thumb {
            background: rgba(255, 215, 0, 0.5);
            border-radius: 10px;
        }

        #itemsContainer::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 215, 0, 0.8);
        }

        @keyframes slideUp {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        @media (max-width: 1400px) {
            .items-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
                padding: 15px;
            }

            #title {
                font-size: 56px;
                letter-spacing: 2px;
            }
        }

        @media (max-width: 1024px) {
            #itemsContainer {
                width: 95%;
                max-width: 1200px;
                bottom: 15px;
                height: calc(100vh - 80px);
            }

            .items-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
                padding: 12px;
            }

            #title {
                font-size: 48px;
                letter-spacing: 2px;
            }

            .item-icon {
                width: 50px;
                height: 50px;
            }

            .item-name {
                font-size: 11px;
            }

            .item-price {
                font-size: 9px;
            }
        }

        @media (max-width: 768px) {
            #itemsContainer {
                width: 95%;
                max-width: 100%;
                bottom: 10px;
                height: calc(100vh - 70px);
            }

            .items-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
                padding: 10px;
            }

            #title {
                font-size: 40px;
                letter-spacing: 1.5px;
                text-shadow: 3px 3px 0px rgba(0, 0, 0, 0.5);
            }

            .item-block {
                border: 2px solid #654321;
                padding: 8px;
            }

            .item-icon {
                width: 40px;
                height: 40px;
                margin-bottom: 6px;
            }

            .item-name {
                font-size: 10px;
            }

            .item-price {
                font-size: 8px;
                margin-top: 3px;
            }
        }

        @media (max-width: 480px) {
            #itemsContainer {
                width: 96%;
                max-width: 100%;
                bottom: 8px;
                height: calc(100vh - 60px);
            }

            .items-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
                padding: 8px;
            }

            #title {
                font-size: 32px;
                letter-spacing: 1px;
                text-shadow: 2px 2px 0px rgba(0, 0, 0, 0.5);
            }

            .item-block {
                border: 2px solid #654321;
                padding: 6px;
            }

            .item-icon {
                width: 32px;
                height: 32px;
                margin-bottom: 4px;
            }

            .item-name {
                font-size: 9px;
            }

            .item-price {
                font-size: 7px;
                margin-top: 2px;
            }

            #itemsContainer::-webkit-scrollbar {
                width: 6px;
            }
        }

        .item-block {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            border: 3px solid #654321;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            color: #fff;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            min-height: 60px;
        }

        .item-block:hover {
            transform: scale(1.05) rotateY(5deg);
            box-shadow: 0 8px 16px rgba(255, 215, 0, 0.4);
        }

        .item-icon {
            width: 60px;
            height: 60px;
            object-fit: contain;
            margin-bottom: 8px;
        }

        .item-name {
            font-size: 12px;
            font-weight: bold;
        }

        .item-price {
            font-size: 10px;
            color: #FFD700;
            margin-top: 4px;
        }

        @font-face {
            font-family: 'Minecraft';
            src: url('data:application/font-woff;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg6SA7AAAAC8AAAAYGNtYXCJjQkzAAABHAAAAGxnYXNwAAAAEAAAAXAAAAAIglypGlCSNCACUCAEAAAAACAEAAAAAA+gB+AAFAAgAhgAAAAAABAAIAAEABCD');
        }

        #loading {
            position: absolute;
            top: 20px;
            left: 20px;
            color: #fff;
            font-size: 14px;
            opacity: 0;
            animation: fadeOut 0.5s ease-out forwards;
            animation-delay: 3s;
        }

        @keyframes fadeOut {
            to {
                opacity: 0;
                pointer-events: none;
            }
        }

        /* Modal Popup Styles */
        #itemModal {
            display: none;
            position: fixed;
            z-index: 999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal-content {
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            margin: 5% auto;
            padding: 30px;
            border: 3px solid #654321;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            color: #fff;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-close {
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            color: #FFD700;
            background: none;
            border: none;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .modal-close:hover {
            transform: scale(1.2);
        }

        .modal-section {
            margin-bottom: 20px;
        }

        .modal-label {
            font-weight: bold;
            color: #FFD700;
            font-size: 14px;
            text-transform: uppercase;
            margin-bottom: 8px;
            display: block;
        }

        .modal-value {
            font-size: 16px;
            line-height: 1.6;
            color: #fff;
            margin-left: 10px;
        }

        .modal-button {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border: none;
            color: #333;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .modal-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }

        .modal-button:active {
            transform: scale(0.98);
        }

        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 20% auto;
                padding: 20px;
                border: 2px solid #654321;
            }

            .modal-header {
                font-size: 22px;
                margin-bottom: 15px;
            }

            .modal-value {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>
    <div id="title">UHHD NATION</div>
    <div id="loading">Loading experience...</div>
    
    <!-- Product Details Modal -->
    <div id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="modalItemName">Product Name</span>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            
            <div class="modal-section">
                <label class="modal-label">üí∞ Price</label>
                <div class="modal-value" id="modalPrice">N/A</div>
            </div>
            
            <div class="modal-section">
                <label class="modal-label">üìä Stock Status</label>
                <div class="modal-value" id="modalStock">N/A</div>
            </div>
            
            <div class="modal-section">
                <label class="modal-label">üìù Description</label>
                <div class="modal-value" id="modalDescription">No description available</div>
            </div>
            
            <div class="modal-section" id="detailsSection" style="display:none;">
                <label class="modal-label">‚ÑπÔ∏è Details</label>
                <div class="modal-value" id="modalDetails"></div>
            </div>
            
            <button class="modal-button" onclick="addToCart()">‚úì Add to Cart</button>
        </div>
    </div>
    
    <div id="itemsContainer">
        <div class="items-grid" id="itemsGrid"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <script>
        // Scene setup
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('canvas'), antialias: true, alpha: true });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x667eea, 0.8);
        camera.position.z = 5;

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);

        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
        directionalLight.position.set(5, 5, 5);
        scene.add(directionalLight);

        const pointLight = new THREE.PointLight(0xffcc00, 0.5);
        pointLight.position.set(-5, 5, 3);
        scene.add(pointLight);

        // Create cookie texture
        function createCookieTexture() {
            const canvas = document.createElement('canvas');
            canvas.width = 256;
            canvas.height = 256;
            const ctx = canvas.getContext('2d');

            // Cookie background
            ctx.fillStyle = '#D2691E';
            ctx.beginPath();
            ctx.arc(128, 128, 120, 0, Math.PI * 2);
            ctx.fill();

            // Cookie spots
            ctx.fillStyle = '#8B4513';
            for (let i = 0; i < 20; i++) {
                const x = Math.random() * 240 + 8;
                const y = Math.random() * 240 + 8;
                const size = Math.random() * 20 + 10;
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }

            const texture = new THREE.CanvasTexture(canvas);
            return texture;
        }

        // Create 3D cookie
        const cookieGeometry = new THREE.CylinderGeometry(1.5, 1.5, 0.3, 32);
        const cookieMaterial = new THREE.MeshStandardMaterial({ 
            map: createCookieTexture(),
            roughness: 0.7,
            metalness: 0.1
        });
        const cookie = new THREE.Mesh(cookieGeometry, cookieMaterial);
        cookie.position.x = 15;
        cookie.position.y = 0;
        cookie.rotation.y = 0;
        scene.add(cookie);

        let cookieStartTime = 0;
        let cookieAnimationStarted = false;
        let googleSheetData = {};

        // Google Sheet URL - Using the published CSV export link
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQI5NKIRXMdq_GTWMeuK5TI1UZNIIhUA4-KOP5kg_e3lBTBp1KlkND-ONLW3nw-kqyj7Hy1wqDaHj43/pub?gid=0&single=true&output=csv';

        // Fetch data from Google Sheet
        async function fetchGoogleSheetData() {
            try {
                const response = await fetch(GOOGLE_SHEET_URL);
                const csvText = await response.text();
                const lines = csvText.trim().split('\n');
                
                // Parse CSV with proper handling of quoted fields
                function parseCSVLine(line) {
                    const result = [];
                    let current = '';
                    let insideQuotes = false;
                    
                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];
                        const nextChar = line[i + 1];
                        
                        if (char === '"') {
                            if (insideQuotes && nextChar === '"') {
                                current += '"';
                                i++;
                            } else {
                                insideQuotes = !insideQuotes;
                            }
                        } else if (char === ',' && !insideQuotes) {
                            result.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    result.push(current.trim());
                    return result;
                }
                
                // Skip header row and parse data
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim() === '') continue;
                    
                    const values = parseCSVLine(lines[i]);
                    if (values[0]) {
                        const itemName = values[0].replace(/"/g, '');
                        googleSheetData[itemName] = {
                            name: values[0].replace(/"/g, ''),
                            price: (values[1] || 'N/A').replace(/"/g, ''),
                            description: (values[2] || 'No description available').replace(/"/g, ''),
                            stock: (values[3] || 'In stock').replace(/"/g, ''),
                            details: (values[4] || '').replace(/"/g, '')
                        };
                    }
                }
                console.log('Google Sheet data loaded:', googleSheetData);
            } catch (error) {
                console.log('Could not load Google Sheet (normal if sheet is private). Using default data.');
            }
        }

        // Fetch Google Sheet data on page load
        fetchGoogleSheetData();

        // Create shopping items grid
        const items = [
            { image: 'https://minecraft.wiki/images/Diamond_Pickaxe.png', name: 'Diamond Pickaxe', price: 'üí∞ 500' },
            { image: 'https://minecraft.wiki/images/Diamond_Sword.png', name: 'Sword', price: 'üí∞ 200' },
            { image: 'https://minecraft.wiki/images/Shield.png', name: 'Shield', price: 'üí∞ 300' },
            { image: 'https://minecraft.wiki/images/Bookshelf.png', name: 'Bookshelf', price: 'üí∞ 150' },
            { image: 'https://minecraft.wiki/images/Oak_Planks.png', name: 'Wood Plank', price: 'üí∞ 10' },
            { image: 'https://minecraft.wiki/images/Bricks.png', name: 'Brick', price: 'üí∞ 25' },
            { image: 'https://minecraft.wiki/images/Diamond.png', name: 'Diamond', price: 'üí∞ 1000' },
            { image: 'https://minecraft.wiki/images/Redstone.png', name: 'Red Stone', price: 'üí∞ 50' },
            { image: 'https://minecraft.wiki/images/Ender_Pearl.png', name: 'Ender Pearl', price: 'üí∞ 400' },
            { image: 'https://minecraft.wiki/images/Golden_Apple.png', name: 'Golden Apple', price: 'üí∞ 800' },
            { image: 'https://minecraft.wiki/images/Wheat.png', name: 'Wheat', price: 'üí∞ 5' },
            { image: 'https://minecraft.wiki/images/Stone.png', name: 'Stone Block', price: 'üí∞ 20' },
            { image: 'https://minecraft.wiki/images/Water_Bucket.png', name: 'Water Bucket', price: 'üí∞ 80' },
            { image: 'https://minecraft.wiki/images/Lava_Bucket.png', name: 'Lava Bucket', price: 'üí∞ 120' },
            { image: 'https://minecraft.wiki/images/Block_of_Amethyst.png', name: 'Moon Stone', price: 'üí∞ 350' },
            { image: 'https://minecraft.wiki/images/Glowstone.png', name: 'Star Shard', price: 'üí∞ 600' },
            { image: 'https://minecraft.wiki/images/Pumpkin.png', name: 'Pumpkin', price: 'üí∞ 40' },
            { image: 'https://minecraft.wiki/images/Red_Mushroom.png', name: 'Mushroom', price: 'üí∞ 35' },
            { image: 'https://minecraft.wiki/images/Oak_Log.png', name: 'Oak Tree', price: 'üí∞ 100' },
            { image: 'https://minecraft.wiki/images/Awkward_Potion.png', name: 'Potion', price: 'üí∞ 250' },
            { image: 'https://minecraft.wiki/images/Arrow.png', name: 'Arrow', price: 'üí∞ 15' },
            { image: 'https://minecraft.wiki/images/Leather_Helmet.png', name: 'Gloves', price: 'üí∞ 180' },
            { image: 'https://minecraft.wiki/images/Diamond_Boots.png', name: 'Boots', price: 'üí∞ 220' },
            { image: 'https://minecraft.wiki/images/Chest.png', name: 'Backpack', price: 'üí∞ 300' },
            { image: 'https://minecraft.wiki/images/Poppy.png', name: 'Flower', price: 'üí∞ 25' },
            { image: 'https://minecraft.wiki/images/Bread.png', name: 'Bread', price: 'üí∞ 30' },
            { image: 'https://minecraft.wiki/images/Potato.png', name: 'Potato', price: 'üí∞ 12' },
            { image: 'https://minecraft.wiki/images/Spider_Eye.png', name: 'Spider Eye', price: 'üí∞ 70' },
            { image: 'https://minecraft.wiki/images/Lightning_Rod.png', name: 'Lightning Rod', price: 'üí∞ 280' },
            { image: 'https://minecraft.wiki/images/Block_of_Iron.png', name: 'Magnet', price: 'üí∞ 320' },
            { image: 'https://minecraft.wiki/images/Cocoa_Beans.png', name: 'Dye Set', price: 'üí∞ 90' },
            { image: 'https://minecraft.wiki/images/Bell.png', name: 'Bell', price: 'üí∞ 120' },
            { image: 'https://minecraft.wiki/images/Decorated_Pot.png', name: 'Ancient Pot', price: 'üí∞ 450' },
            { image: 'https://minecraft.wiki/images/Banner.png', name: 'Banner', price: 'üí∞ 60' },
            { image: 'https://minecraft.wiki/images/Bed.png', name: 'Bed', price: 'üí∞ 140' },
            { image: 'https://minecraft.wiki/images/Oak_Door.png', name: 'Lock', price: 'üí∞ 110' }
        ];

        // Populate items grid
        const itemsGrid = document.getElementById('itemsGrid');
        items.forEach(item => {
            const itemBlock = document.createElement('div');
            itemBlock.className = 'item-block';
            itemBlock.innerHTML = `
                <img src="${item.image}" alt="${item.name}" class="item-icon" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 64 64%22><rect fill=%22%238B4513%22 width=%2264%22 height=%2264%22/><text x=%2232%22 y=%2240%22 font-size=%2224%22 text-anchor=%22middle%22 fill=%22white%22>?</text></svg>'" />
                <div class="item-name">${item.name}</div>
                <div class="item-price">${item.price}</div>
            `;
            itemBlock.addEventListener('click', () => {
                // Get data from Google Sheet by item name
                const sheetData = googleSheetData[item.name];
                
                if (sheetData && sheetData.name) {
                    // Populate modal with Google Sheet data
                    document.getElementById('modalItemName').textContent = sheetData.name;
                    document.getElementById('modalPrice').textContent = sheetData.price;
                    document.getElementById('modalStock').textContent = sheetData.stock;
                    document.getElementById('modalDescription').textContent = sheetData.description;
                    
                    // Show or hide details section based on whether there are details
                    const detailsSection = document.getElementById('detailsSection');
                    if (sheetData.details && sheetData.details.trim()) {
                        document.getElementById('modalDetails').textContent = sheetData.details;
                        detailsSection.style.display = 'block';
                    } else {
                        detailsSection.style.display = 'none';
                    }
                    
                    // Open modal
                    openModal();
                } else {
                    // Fallback - show with item name only
                    document.getElementById('modalItemName').textContent = item.name;
                    document.getElementById('modalPrice').textContent = item.price;
                    document.getElementById('modalStock').textContent = 'In stock';
                    document.getElementById('modalDescription').textContent = 'Product details available in Google Sheet';
                    document.getElementById('detailsSection').style.display = 'none';
                    openModal();
                }
            });
            itemsGrid.appendChild(itemBlock);
        });

        // Modal Functions
        function openModal() {
            document.getElementById('itemModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('itemModal').style.display = 'none';
        }

        function addToCart() {
            const itemName = document.getElementById('modalItemName').textContent;
            closeModal();
            // You can add custom callback here, e.g., send to backend
            console.log(`Added ${itemName} to cart`);
        }

        // Close modal when clicking outside of it
        window.addEventListener('click', (event) => {
            const modal = document.getElementById('itemModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        function animate() {
            requestAnimationFrame(animate);

            const currentTime = Date.now() / 1000;

            // Start cookie animation after 1 second
            if (currentTime > 1 && !cookieAnimationStarted) {
                cookieAnimationStarted = true;
                cookieStartTime = currentTime;
            }

            // Animate cookie rolling from right to left
            if (cookieAnimationStarted) {
                const elapsed = currentTime - cookieStartTime;
                const duration = 3; // 3 seconds for animation

                if (elapsed < duration) {
                    // Move cookie from right to left
                    cookie.position.x = 15 - (elapsed / duration) * 30;
                    // Rotate cookie for rolling effect (rolling along x axis)
                    cookie.rotation.x += 0.1;
                } else {
                    // Keep cookie off screen after animation
                    cookie.position.x = -15;
                }
            }

            renderer.render(scene, camera);
        }

        animate();

        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>

</body>
</html>